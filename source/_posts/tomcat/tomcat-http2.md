---
title: tomcat http2
copyright: true
date: 2019-07-31 18:43:13
categories:
    - tomcat
tags:
    - tomcat
    - http2
---
http2协议简介。
tomcat配置http2。

<!-- more -->

在http1里，浏览器对一个地址发起访问，通常建立4~6个连接，这样就可以同时请求多个资源，就能对一个页面上的多个静态文件同时加载。
有两个问题
(1) 即使是多个连接，仍然不够
(2) 在服务器端，一个连接对应一个线程，所以建立和销毁一个连接是非常昂贵的（握手和线程资源），而传输非常短暂，导致大量的连接/线程被反复的建立和销毁

http1 针对这两个问题的解决方法
(1) 压缩、合并静态资源，不再细分开发和传输的压缩
所导致的问题：
1、尽管压缩与合并是良好的习惯，但多文件仍然无法避免
(2) head of line and keep alive
应该减少线程的建立与销毁的耗时，复用线程是一个好主意，因此就出现了 keep alive，延长客户端和服务端连接的存活时间。
但是http1有个重大缺陷--head of line，所有的数据包都是按顺序发送的，如果一个包出错，这个连接里后续的包都得等着

http2 的解决方案
从http1的两个解决方法来看，第一需要多个连接的问题仍然没有解决，第二单个连接阻塞的问题没有解决。
而在http2，这些问题已经解决，连接复用，多个文件请求也可以快速完成。
(1) 在http>tcp中间加一个数据的二进制分帧操作取代http1的文本传输，使数据可以乱序发送，不会再阻塞
(2) 因为数据的实际传输时间非常短暂，一个http1连接大部分时间都非常空闲，http2得益于二进制帧，这些空闲时间也可以被用于传输，所以可以在一个连接里传输大量数据，不再需要更多的连接。
(3) http2提供了头部压缩，解决http1时代的大头问题
(4) http2提供了服务端推送，服务器可以主动向客户端推送资源，而不用等待客户端的请求到来。

tomcat的配置